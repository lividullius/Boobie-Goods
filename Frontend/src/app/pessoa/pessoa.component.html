<div class="container py-4">
  <!-- Cabeçalho com botões lado a lado -->
  <div class="d-flex justify-content-between align-items-center mb-3">
    <h2 class="m-0">Pessoas</h2>
    
    <!-- Botões lado a lado -->
    <div class="d-flex gap-2">
      <button class="btn criar-contrato-button"
              data-bs-toggle="modal"
              data-bs-target="#modalPessoa">
        Criar Pessoa
      </button>
      <button class="btn criar-contrato-button"
              data-bs-toggle="modal"
              data-bs-target="#modalPerfil">
        Criar Perfil
      </button>
      <button class="btn criar-contrato-button"
              data-bs-toggle="modal"
              data-bs-target="#modalAlocacao">
        Criar Alocação
      </button>
    </div>
  </div>

  <!-- Mensagem de erro -->
  <div *ngIf="error" class="alert alert-warning mb-3" role="alert">
    <i class="bi bi-exclamation-triangle me-2"></i>
    {{ error }}
    <button type="button" class="btn btn-sm btn-outline-warning ms-2" (click)="refreshPessoas()">
      Tentar novamente
    </button>
  </div>

  <!-- Card / Tabela de Pessoas -->
  <div class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="table-light">
          <tr>
            <th>Nome</th>
            <th>Perfis</th>
          </tr>
        </thead>
        <tbody>
          <!-- Loading -->
          <tr *ngIf="loading">
            <td colspan="2" class="text-center py-4">
              <div class="spinner-border text-primary" role="status">
                <span class="visually-hidden">Carregando...</span>
              </div>
              <p class="mt-2 mb-0">Carregando pessoas...</p>
            </td>
          </tr>
          
          <!-- Dados -->
          <tr *ngFor="let pessoa of pessoas" [class.d-none]="loading">
            <td>{{ pessoa.nome }}</td>
            <td>
              <span *ngFor="let perfil of pessoa.perfis; let last = last" 
                    class="badge bg-secondary me-1">
                {{ perfil }}
              </span>
              <span *ngIf="!pessoa.perfis || pessoa.perfis.length === 0" 
                    class="text-muted fst-italic">
                Nenhum perfil
              </span>
            </td>
          </tr>
          
          <!-- Estado vazio -->
          <tr *ngIf="!loading && pessoas.length === 0">
            <td colspan="2" class="text-center py-4 text-muted">
              <i class="bi bi-person-x fs-1 d-block mb-2"></i>
              Nenhuma pessoa encontrada
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>

<!-- Modais -->
<app-modal-criacao-pessoa></app-modal-criacao-pessoa>
<app-modal-criacao-perfil></app-modal-criacao-perfil>
<app-modal-criacao-alocacao></app-modal-criacao-alocacao>
